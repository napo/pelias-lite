{
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "name.default": {
                            "analyzer": "peliasQuery",
                            "boost": 1,
                            "query": "povo",
                            "cutoff_frequency": 0.01,
                            "minimum_should_match": "1<-1 3<-25%"
                        }
                    }
                }
            ],
            "should": [
                {
                    "match_phrase": {
                        "phrase.default": {
                            "query": "povo",
                            "boost": 1,
                            "slop": 2,
                            "analyzer": "peliasPhrase"
                        }
                    }
                },
                {
                    "function_score": {
                        "query": {
                            "match_all": {}
                        },
                        "max_boost": 20,
                        "functions": [
                            {
                                "field_value_factor": {
                                    "modifier": "log1p",
                                    "field": "popularity",
                                    "missing": 1
                                },
                                "weight": 1
                            }
                        ],
                        "score_mode": "first",
                        "boost_mode": "replace"
                    }
                },
                {
                    "function_score": {
                        "query": {
                            "match_all": {}
                        },
                        "max_boost": 20,
                        "functions": [
                            {
                                "field_value_factor": {
                                    "modifier": "log1p",
                                    "field": "population",
                                    "missing": 1
                                },
                                "weight": 2
                            }
                        ],
                        "score_mode": "first",
                        "boost_mode": "replace"
                    }
                }
            ],
            "filter": [
                {
                    "terms": {
                        "layer": [
                            "venue",
                            "street",
                            "country",
                            "macroregion",
                            "region",
                            "county",
                            "localadmin",
                            "locality",
                            "borough",
                            "neighbourhood",
                            "continent",
                            "empire",
                            "dependency",
                            "macrocounty",
                            "macrohood",
                            "microhood",
                            "disputed",
                            "postalcode",
                            "ocean",
                            "marinearea"
                        ]
                    }
                }
            ]
        }
    },
    "size": 20,
    "track_scores": true,
    "sort": [
        "_score"
    ]
}